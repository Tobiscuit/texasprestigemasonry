(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,92989,(e,t,r)=>{t.exports=e.r(76562)},95187,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var s={callServer:function(){return i.callServer},createServerReference:function(){return c.createServerReference},findSourceMapURL:function(){return n.findSourceMapURL}};for(var a in s)Object.defineProperty(r,a,{enumerable:!0,get:s[a]});let i=e.r(32120),n=e.r(92245),c=e.r(35326)},76479,e=>{"use strict";var t=e.i(47167),r=e.i(43476),s=e.i(71645),a=e.i(92989),i=e.i(95187);let n=(0,i.createServerReference)("00aba081437e8785cc06bcae6f991762884b863728",i.callServer,void 0,i.findSourceMapURL,"getAvailableJobs"),c=(0,i.createServerReference)("40555f63735da704801679321c106ecf7098108ccd",i.callServer,void 0,i.findSourceMapURL,"acceptJob"),l=(0,i.createServerReference)("404bf95009597ceb48c6e4eb88ea5ed6f4b23804c2",i.callServer,void 0,i.findSourceMapURL,"savePushSubscription");function o({user:e}){(0,a.useRouter)();let[i,o]=(0,s.useState)(!1),[d,u]=(0,s.useState)(null),[b,x]=(0,s.useState)(null),[p,g]=(0,s.useState)([]),h=async()=>{g(await n())};(0,s.useEffect)(()=>{h();let e=setInterval(h,15e3);return()=>clearInterval(e)},[]);let m=async e=>{confirm("Accept this assignment?")&&(await c(e),await h())};(0,s.useEffect)(()=>{"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(e=>{x(e),e.pushManager.getSubscription().then(e=>{e&&!(e.expirationTime&&Date.now()>e.expirationTime)&&(u(e),o(!0))})})},[]);let f=async()=>{if(b)try{let e=await b.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:v(t.default.env.NEXT_PUBLIC_VAPID_PUBLIC_KEY)});u(e),o(!0),console.log("Web Push Subscription:",JSON.stringify(e)),await l(JSON.parse(JSON.stringify(e))),alert("Subscribed to Dispatch Alerts!")}catch(e){console.error("Failed to subscribe",e)}},v=e=>{let t="=".repeat((4-e.length%4)%4),r=(e+t).replace(/\-/g,"+").replace(/_/g,"/"),s=window.atob(r),a=new Uint8Array(s.length);for(let e=0;e<s.length;++e)a[e]=s.charCodeAt(e);return a},w=e?.name?e.name.split(" ").map(e=>e[0]).join("").substring(0,2).toUpperCase():"??";return(0,r.jsx)("div",{className:"min-h-screen bg-midnight-slate text-white font-work-sans p-6",children:(0,r.jsxs)("div",{className:"max-w-md mx-auto",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,r.jsxs)("h1",{className:"text-2xl font-black uppercase tracking-widest flex items-center gap-2",children:[(0,r.jsx)("span",{className:"w-3 h-3 bg-burnished-gold rounded-full animate-pulse"}),"Tech Ops"]}),(0,r.jsx)("div",{className:"w-10 h-10 rounded-full bg-white/10 flex items-center justify-center font-bold text-burnished-gold",children:w})]}),(0,r.jsxs)("div",{className:"mb-8 bg-white/5 rounded-2xl p-4 border border-white/10 flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest",children:"Uplink Status"}),(0,r.jsx)("div",{className:`font-bold ${i?"text-green-400":"text-gray-500"}`,children:i?"CONNECTED (PUSH ACTIVE)":"OFFLINE"})]}),!i&&(0,r.jsx)("button",{onClick:f,className:"bg-burnished-gold text-midnight-slate px-4 py-2 rounded-xl text-xs font-black uppercase tracking-wide hover:bg-yellow-400 transition-colors",children:"Enable Alerts"})]}),(0,r.jsx)("h2",{className:"text-sm font-bold text-gray-400 uppercase tracking-widest mb-4",children:"Pending Assignments"}),(0,r.jsx)("div",{className:"space-y-4",children:0===p.length?(0,r.jsx)("div",{className:"text-gray-500 italic text-center py-8",children:"No missions assigned. Standby."}):p.map(e=>(0,r.jsxs)("div",{className:"bg-white/10 rounded-2xl p-5 border border-white/10 hover:bg-white/15 transition-all",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,r.jsx)("span",{className:`px-2 py-1 rounded text-[10px] font-black uppercase tracking-wide ${"Emergency"===e.urgency?"bg-red-500/20 text-red-400 border border-red-500/30":"bg-amber-500/20 text-amber-400 border border-amber-500/30"}`,children:e.urgency}),(0,r.jsx)("span",{className:"text-xs font-mono text-gray-400",children:e.ticketId})]}),(0,r.jsx)("h3",{className:"text-lg font-bold mb-1",children:e.customerName}),(0,r.jsx)("p",{className:"text-gray-300 text-sm mb-1",children:e.customerAddress}),(0,r.jsxs)("p",{className:"text-gray-400 text-xs italic mb-4 line-clamp-2",children:['"',e.issue,'"']}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,r.jsx)("button",{className:"bg-white/10 py-3 rounded-xl text-xs font-bold uppercase tracking-wide hover:bg-white/20 transition-colors",children:"Decline"}),(0,r.jsx)("button",{onClick:()=>m(e.id),className:"bg-green-500 text-white py-3 rounded-xl text-xs font-bold uppercase tracking-wide hover:bg-green-400 transition-colors shadow-lg shadow-green-900/20",children:"Accept Mission"})]})]},e.id))})]})})}e.s(["default",()=>o],76479)}]);