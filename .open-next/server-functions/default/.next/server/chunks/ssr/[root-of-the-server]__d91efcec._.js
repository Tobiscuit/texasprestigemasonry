module.exports=[37936,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"registerServerReference",{enumerable:!0,get:function(){return d.registerServerReference}});let d=a.r(11857)},13095,(a,b,c)=>{"use strict";function d(a){for(let b=0;b<a.length;b++){let c=a[b];if("function"!=typeof c)throw Object.defineProperty(Error(`A "use server" file can only export async functions, found ${typeof c}.
Read more: https://nextjs.org/docs/messages/invalid-use-server-value`),"__NEXT_ERROR_CODE",{value:"E352",enumerable:!1,configurable:!0})}}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"ensureServerEntryExports",{enumerable:!0,get:function(){return d}})},54799,(a,b,c)=>{b.exports=a.x("crypto",()=>require("crypto"))},21121,a=>{"use strict";var b=a.i(37936);a.i(70396);var c=a.i(73727),d=a.i(54799);let e=async(a,b,c)=>{try{let e="production"===process.env.SQUARE_ENVIRONMENT?"production":"sandbox",f=await fetch(`${"production"===e?"https://connect.squareup.com":"https://connect.squareupsandbox.com"}/v2/payments`,{method:"POST",headers:{"Square-Version":"2024-01-18",Authorization:`Bearer ${process.env.SQUARE_ACCESS_TOKEN}`,"Content-Type":"application/json"},body:JSON.stringify({source_id:a,idempotency_key:(0,d.randomUUID)(),amount_money:{amount:b,currency:"USD"},note:c})}),g=await f.json();if(!f.ok||!g.payment||"COMPLETED"!==g.payment.status&&"APPROVED"!==g.payment.status){if(g.errors&&g.errors.length>0)throw Error(g.errors[0].detail||g.errors[0].category||"Payment Failed");throw Error("Payment failed. Status: "+g.payment?.status)}return g.payment}catch(a){throw console.error("Square Service Error:",a),Error(a.message||"Unknown Square payment error")}};var f=a.i(20805),g=a.i(13095);try{process.env.NEXT_PUBLIC_VAPID_PUBLIC_KEY&&process.env.VAPID_PRIVATE_KEY&&f.default.setVapidDetails("mailto:office@texasprestigemasonry.com",process.env.NEXT_PUBLIC_VAPID_PUBLIC_KEY,process.env.VAPID_PRIVATE_KEY)}catch(a){console.error("Error configuring Web Push in booking:",a)}async function h(a){return 1}async function i(a,b){let d=b.get("guestName"),f=b.get("guestEmail"),g=b.get("guestPhone"),i=b.get("guestAddress"),j=b.get("guestPassword");b.get("issueDescription"),b.get("urgency"),b.get("scheduledTime");let k=b.get("sourceId");try{await h({guestName:d,guestEmail:f,guestPhone:g,guestAddress:i,guestPassword:j}),await e(k,9900,`Trip Fee for ${d} (${f})`)}catch(b){console.error("Booking Error:",b);let a="Failed to process booking.";return b.message&&(a=b.message),{error:a}}(0,c.redirect)("/portal?success=booked")}(0,g.ensureServerEntryExports)([i]),(0,b.registerServerReference)(i,"60358492ef0e16abc4b671ed2893f129d75f3bc93b",null),a.s([],35164),a.i(35164),a.s(["60358492ef0e16abc4b671ed2893f129d75f3bc93b",()=>i],21121)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__d91efcec._.js.map